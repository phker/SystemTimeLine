<html>
<head>
   <script src="https://cdn.bootcdn.net/ajax/libs/antv-g2/4.1.7/g2.min.js"></script>
</head>
<body>
  
<div id="timeline"></div>
</body>
</html>



<script>
// import { Chart, registerShape } from '@antv/g2';
// const data = [
//   { jobname: 'init', time: 1 , type:'start'},
//   { jobname: 'init', time: 2 , type:'end'},
//   { jobname: 'load', time: 3 , type:'start'},
//   { jobname: 'load', time: 4 , type:'end'},
//   { jobname: 'save', time: 5 , type:'start'},
//   { jobname: 'save', time: 6 , type:'end'}
// ];
const data =[{'jobname': '36624DoScoring', 'time': 0.0, 'type': 'start'}, {'jobname': '图片前处理', 'time': 0.07517290115356445, 'type': 'start'}, {'jobname': '图片前处理', 'time': 0.1054379940032959, 'type': 'end'}, {'jobname': 'AI图片识别', 'time': 0.11617732048034668, 'type': 'start'}, {'jobname': 'AI图片识别', 'time': 0.3172934055328369, 'type': 'end'}, {'jobname': 'AI图片后处理', 'time': 0.3172934055328369, 'type': 'start'}, {'jobname': '上传到OSS', 'time': 0.31827235221862793, 'type': 'start'}, {'jobname': '上传到OSS', 'time': 0.40027809143066406, 'type': 'end'}, {'jobname': '单通道求新投入的垃圾3', 'time': 0.40125560760498047, 'type': 'start'}, {'jobname': '过滤小面积物品', 'time': 0.4979109764099121, 'type': 'start'}, {'jobname': '过滤小面积物品', 'time': 0.5145049095153809, 'type': 'end'}, {'jobname': '添加色标', 'time': 0.5340309143066406, 'type': 'start'}, {'jobname': '添加色标', 'time': 0.5457479953765869, 'type': 'end'}, {'jobname': '上传到OSS', 'time': 0.555509090423584, 'type': 'start'}, {'jobname': '上传到OSS', 'time': 0.7214787006378174, 'type': 'end'}, {'jobname': '过滤小面积物品', 'time': 0.7214787006378174, 'type': 'start'}, {'jobname': '过滤小面积物品', 'time': 0.7351467609405518, 'type': 'end'}, {'jobname': '添加色标', 'time': 0.7468631267547607, 'type': 'start'}, {'jobname': '添加色标', 'time': 0.7566263675689697, 'type': 'end'}, {'jobname': '上传到OSS', 'time': 0.7663886547088623, 'type': 'start'}, {'jobname': '上传到OSS', 'time': 0.933337926864624, 'type': 'end'}, {'jobname': 'AI图片后处理', 'time': 0.933337926864624, 'type': 'end'}, {'jobname': '识别后打分', 'time': 0.9352905750274658, 'type': 'start'}, {'jobname': '识别后打分', 'time': 0.9538373947143555, 'type': 'end'}, {'jobname': 'Send2WeiXin2', 'time': 0.9606738090515137, 'type': 'start'}, {'jobname': 'Send2WeiXin2', 'time': 0.9606738090515137, 'type': 'end'}, {'jobname': 'Send2DaBaShou', 'time': 0.9606738090515137, 'type': 'start'}, {'jobname': 'Send2DaBaShou', 'time': 0.9606738090515137, 'type': 'end'}, {'jobname': '36624SaveChange', 'time': 0.9606738090515137, 'type': 'start'}, {'jobname': '36624SaveChange', 'time': 0.973365306854248, 'type': 'end'}, {'jobname': '36624DoScoring', 'time': 0.9958207607269287, 'type': 'end'}]


maxtime = 0
for (let i = 0; i < data.length; i++) {
  const element = data[i];
  if(element.time>maxtime){
    maxtime = element.time;
  }
}

G2.registerShape('point', 'image', {
  draw(cfg, container) {


    cfg.points = this.parsePoints(cfg.points);
    const coord = this.coordinate;
    container.addShape('line', {
      attrs: {
        x1: cfg.points[0].x,
        y1: cfg.points[0].y,
        x2: cfg.points[0].x,
        y2: coord.start.y,
        stroke: '#ccc',
        lineWidth: 1,
        lineDash: [4, 2]
      }
    });
    return container.addShape('image', {
      // attrs: {
      //   x: cfg.points[0].x - (12 * cfg.size / 2),
      //   y: cfg.points[0].y - 12 * cfg.size,
      //   width: 12 * cfg.size,
      //   height: 12 * cfg.size,
      //   img: 'https://gw.alipayobjects.com/zos/rmsportal/dWJWRLWfpOEbwCyxmZwu.png' //cfg.shape[1]
      // } 
      attrs: {
        x: cfg.points[0].x - (12 * 1 / 2),
        y: cfg.points[0].y - 12 * 1,
        width: 12 * 1,
        height: 12 * 1,
        img: 'https://gw.alipayobjects.com/zos/rmsportal/dWJWRLWfpOEbwCyxmZwu.png' //cfg.shape[1]
      }
    });
  }
}); 
const imageMap = {
  'Internet Explorer': 'https://gw.alipayobjects.com/zos/rmsportal/eOYRaLPOmkieVvjyjTzM.png',
  Chrome: 'https://gw.alipayobjects.com/zos/rmsportal/dWJWRLWfpOEbwCyxmZwu.png',
  Firefox: 'https://gw.alipayobjects.com/zos/rmsportal/ZEPeDluKmAoTioCABBTc.png',
  Safari: 'https://gw.alipayobjects.com/zos/rmsportal/eZYhlLzqWLAYwOHQAXmc.png',
  Opera: 'https://gw.alipayobjects.com/zos/rmsportal/vXiGOWCGZNKuVVpVYQAw.png',
  start: 'https://gw.alipayobjects.com/zos/rmsportal/vXiGOWCGZNKuVVpVYQAw.png',
  Undetectable: 'https://gw.alipayobjects.com/zos/rmsportal/NjApYXminrnhBgOXyuaK.png'
};
const chart = new G2.Chart({
  container: 'timeline',
  autoFit: true,
  height: 500,
});
chart.data(data);
chart.scale('time', {
  nice: false,
  max: maxtime * 1.2,
  min: 0
});
chart.legend(false);
chart.axis('value', false);
chart.tooltip({
  showMarkers: false,
});
chart.point().position('time*jobname')
  .size('time')
  .color('jobname')
  .shape('jobname', (jobname) => {
    // return ['image', imageMap[jobname]]; // 根据具体的字段指定 shape
    return ['image', imageMap[jobname]]; // 根据具体的字段指定 shape
  })
  // .label('time', {
  //   offset: -20,
  //   style: {
  //     fontSize: 16 // 文本大小
  //   }
  // })
  ;
chart.render();


</script>
